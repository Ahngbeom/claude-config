# Compact Strategy Guide

Claude Code 세션에서 토큰을 효율적으로 관리하는 전략입니다.

## 핵심 원칙

### 컨텍스트 임계값

| 사용량 | 상태 | 권장 조치 |
|--------|------|----------|
| **0-60%** | 안전 | 정상 작업 |
| **60-80%** | 주의 | `/compact` 고려 |
| **80-95%** | 위험 | `/compact` 필수 |
| **95%+** | 자동 compact | 시스템 자동 처리 |

---

## /compact vs /clear

| 명령어 | 용도 | 보존 내용 |
|--------|------|----------|
| `/compact` | 같은 작업 계속 | 요약된 컨텍스트 유지 |
| `/clear` | 완전히 새 작업 | 모든 컨텍스트 삭제 |

### 언제 /compact?

- 같은 프로젝트에서 다른 기능으로 전환
- 컨텍스트 80% 이상 사용
- 긴 세션 (2시간+) 진행 중
- 에러 해결 후 정상 작업 복귀

### 언제 /clear?

- 완전히 다른 프로젝트로 전환
- 이전 컨텍스트가 전혀 필요 없음
- 새로운 대화 주제 시작

---

## /compact 사용법

### 기본 사용

```bash
/compact
```

### 특정 내용 보존

```bash
/compact 코드 변경사항과 에러 메시지 위주로 보존해줘
```

### 권장 보존 항목

```bash
/compact 다음 내용 위주로 보존:
- 현재 작업 중인 기능
- 수정한 파일 목록
- 발생한 에러와 해결 방법
- 다음 단계 계획
```

---

## 토큰 절약 팁

### 1. 직접 파일 참조

```bash
# 좋음 - 정확한 경로 지정
"src/components/Button.tsx 파일 수정해줘"

# 나쁨 - 전체 탐색 필요
"버튼 컴포넌트 파일 찾아서 수정해줘"
```

### 2. 구체적인 라인 지정

```bash
# 좋음
"Button.tsx:25-30 라인의 onClick 핸들러 수정"

# 나쁨
"Button 컴포넌트에서 클릭 관련 부분 수정"
```

### 3. 명확한 작업 범위

```bash
# 좋음
"UserService.ts의 getUserById 함수에 캐싱 추가"

# 나쁨
"유저 관련 서비스 최적화해줘"
```

---

## 세션 관리 전략

### 작업 유형별 권장

| 작업 유형 | 예상 토큰 | 전략 |
|----------|----------|------|
| 버그 수정 | 낮음 | 단일 세션 |
| 기능 구현 | 중간 | 단계별 `/compact` |
| 리팩토링 | 높음 | 파일별 세션 분리 |
| 대규모 변경 | 매우 높음 | 기능별 `/clear` |

### 장시간 세션

```bash
# 2시간+ 세션 시
1. 주요 진행상황 메모
2. /compact로 컨텍스트 정리
3. 메모 내용으로 컨텍스트 복원
```

---

## 모니터링

### 컨텍스트 확인

```bash
/context
```

### 비용 확인

```bash
/cost
```

---

## 요약

1. **80% 이상** → `/compact` 실행
2. **다른 프로젝트** → `/clear` 실행
3. **파일 경로는 정확하게** 지정
4. **작업 범위는 구체적으로** 명시
5. **장시간 세션**은 주기적으로 정리

---

*위치: ~/.claude/COMPACT-STRATEGY.md*
